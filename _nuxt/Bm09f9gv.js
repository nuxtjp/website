const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CRc5OR8y.js","./Dk7qOd9J.js","./entry.DjaJII7C.css","./CAJmy4A5.js"])))=>i.map(i=>d[i]);
import{as as j,au as U,b as R}from"./Dk7qOd9J.js";import{t as W}from"./CAJmy4A5.js";const k=/\d/,B=["-","_","/","."];function D(e=""){if(!k.test(e))return e!==e.toLowerCase()}function L(e,s){const n=B,r=[];if(!e||typeof e!="string")return r;let i="",t,o;for(const l of e){const p=n.includes(l);if(p===!0){r.push(i),i="",t=void 0;continue}const a=D(l);if(o===!1){if(t===!1&&a===!0){r.push(i),i=l,t=a;continue}if(t===!0&&a===!1&&i.length>1){const u=i.at(-1);r.push(i.slice(0,Math.max(0,i.length-1))),i=u+l,t=a;continue}}i+=l,t=a,o=p}return r.push(i),r}function x(e){return e?e[0].toUpperCase()+e.slice(1):""}function P(e,s){return e?(Array.isArray(e)?e:L(e)).map(n=>x(s?.normalize?n.toLowerCase():n)).join(""):""}function z(e,s){return e?(Array.isArray(e)?e:L(e)).map(n=>n.toLowerCase()).join("-"):""}const $=(e,s)=>{const n=e._conditions;return n.length>0?`(${n.join(` ${s} `)})`:""},C=e=>{const s=[],n={_conditions:s,where(r,i,t){let o;switch(i.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(t)){const l=t.map(p=>g(p)).join(", ");o=`"${String(r)}" ${i.toUpperCase()} (${l})`}else throw new TypeError(`Value for ${i} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(t)&&t.length===2)o=`"${String(r)}" ${i.toUpperCase()} ${g(t[0])} AND ${g(t[1])}`;else throw new Error(`Value for ${i} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(r)}" ${i.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(r)}" ${i.toUpperCase()} ${g(t)}`;break;default:o=`"${String(r)}" ${i} ${g(typeof t=="boolean"?Number(t):t)}`}return s.push(`${o}`),n},andWhere(r){const i=r(C());return s.push($(i,"AND")),n},orWhere(r){const i=r(C());return s.push($(i,"OR")),n}};return n},F=(e,s)=>{const n={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},r={__params:n,andWhere(t){const o=t(C());return n.conditions.push($(o,"AND")),r},orWhere(t){const o=t(C());return n.conditions.push($(o,"OR")),r},path(t){return r.where("path","=",j(t))},skip(t){return n.offset=t,r},where(t,o,l){return r.andWhere(p=>p.where(String(t),o,l)),r},limit(t){return n.limit=t,r},select(...t){return t.length&&n.selectedFields.push(...t),r},order(t,o){return n.orderBy.push(`"${String(t)}" ${o}`),r},async all(){return s(e,i()).then(t=>t||[])},async first(){return s(e,i({limit:1})).then(t=>t[0]||null)},async count(t="*",o=!1){return s(e,i({count:{field:String(t),distinct:o}})).then(l=>l[0].count)}};function i(t={}){let o="SELECT ";if(t?.count)o+=`COUNT(${t.count.distinct?"DISTINCT ":""}${t.count.field}) as count`;else{const p=Array.from(new Set(n.selectedFields));o+=p.length>0?p.map(a=>`"${String(a)}"`).join(", "):"*"}o+=` FROM ${W[String(e)]}`,n.conditions.length>0&&(o+=` WHERE ${n.conditions.join(" AND ")}`),n.orderBy.length>0?o+=` ORDER BY ${n.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const l=t?.limit||n.limit;return l>0&&(n.offset>0?o+=` LIMIT ${l} OFFSET ${n.offset}`:o+=` LIMIT ${l}`),o}return r};function g(e){return`'${String(e).replace(/'/g,"''")}'`}function I(e){return s=>(s=s||{},(e||[]).filter(n=>typeof s[n]<"u").reduce((n,r)=>Object.assign(n,{[r]:s[r]}),{}))}async function q(e,s=[]){e.__params?.orderBy?.length||(e=e.order("stem","ASC"));const r=await e.orWhere(a=>a.where("navigation","<>","false").where("navigation","IS NULL")).select("navigation","stem","path","title","meta",...s||[]).all(),{contents:i,configs:t}=r.reduce((a,u)=>{if(String(u.stem).split("/").pop()===".navigation"){u.title=u.title?.toLowerCase()==="navigation"?"":u.title;const d=u.path.split("/").slice(0,-1).join("/")||"/";a.configs[d]={...u,...u.body}}else a.contents.push(u);return a},{configs:{},contents:[]}),o=a=>({...I(["title",...s])(a),...a.meta,...O(a?.navigation)?a.navigation:{}}),l=a=>({...I(["title",...s])(a),...O(a?.navigation)?a.navigation:{}}),p=i.reduce((a,u)=>{const d=u.path.substring(1).split("/"),b=u.stem.split("/"),E=!!b[b.length-1]?.match(/([1-9]\d*\.)?index/g),T=c=>({title:c.title,path:c.path,stem:c.stem,children:[],...l(c)}),h=T(u);if(E){const c=t[h.path];if(typeof c?.navigation<"u"&&c?.navigation===!1)return a;if(u.path!=="/"){const f=T(u);h.children.push(f)}c&&Object.assign(h,o(c))}if(d.length===1){const c=a.find(f=>f.path===h.path&&f.page===!1);return E&&c?Object.assign(c,{page:void 0,children:[...h.children||[],...c.children||[]]}):a.push(h),a}const v=d.slice(0,-1).reduce((c,f,A)=>{const N="/"+d.slice(0,A+1).join("/"),m=t[N];if(typeof m?.navigation<"u"&&m.navigation===!1)return[];let y=c.find(S=>S.path===N);if(!y){const S=m?o(m):{};y={...S,title:S.title||M(f),path:N,stem:b.slice(0,A+1).join("/"),children:[],page:!1},c.push(y)}return y.children},a),w=v.find(c=>c.path===h.path&&c.page===!1);return w?Object.assign(w,{...h,page:void 0,children:[...h.children||[],...w.children||[]]}):v.push(h),a},[]);return _(p)}function _(e){const s=e;for(const n of s)n.children?.length?_(n.children):delete n.children;return e}function O(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const M=e=>e.split(/[\s-]/g).map(P).join(" "),Q=e=>{const s=U()?.ssrContext?.event;return F(e,(n,r)=>V(s,n,r))};function J(e,s){return H(e,n=>q(n,s))}async function V(e,s,n){return G(s,n)}async function G(e,s){return await R(()=>import("./CRc5OR8y.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(r=>r.loadDatabaseAdapter(e)).then(r=>r.all(s))}function H(e,s){const n=Q(e),r={where(i,t,o){return n.where(String(i),t,o),r},andWhere(i){return n.andWhere(i),r},orWhere(i){return n.orWhere(i),r},order(i,t){return n.order(String(i),t),r},then(i,t){return s(n).then(i,t)},catch(i){return this.then(void 0,i)},finally(i){return this.then(void 0,void 0).finally(i)},get[Symbol.toStringTag](){return"Promise"}};return r}export{J as a,z as k,P as p,Q as q};
